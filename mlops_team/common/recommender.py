# 옷추천 로직 (FastAPI 서버, Streamlit가 공통으로 사용함)

# 스타일별 추천 데이터를 딕셔너리로 정리
STYLE_RECOMMENDATIONS = {
    "5도 이하": {
        "items": {
            "캐주얼": {"아우터": ["🧥 롱패딩", "🧥 숏패딩"], "상의": ["🧶 두꺼운 니트", "👕 기모 맨투맨"], "하의": ["👖 기모 바지", "👖 코듀로이 팬츠"]},
            "비즈니스": {"아우터": ["🧥 두꺼운 오버핏 코트"], "상의": ["🧶 터틀넥 니트", "👔 셔츠"], "하의": ["👖 울 슬랙스"]},
            "스포티": {"아우터": ["🧥 벤치파카", "🧥 윈드브레이커"], "상의": ["👕 기능성 긴팔", "👕 후드티"], "하의": ["👖 트레이닝 팬츠"]},
            "페미닌": {"아우터": ["🧥 알파카 코트"], "상의": ["🧶 앙고라 니트"], "하의": ["👗 롱 기장 스커트", "🧦 두꺼운 스타킹"]},
            "미니멀": {"아우터": ["🧥 블랙 패딩"], "상의": ["👕 기본 터틀넥"], "하의": ["👖 와이드 슬랙스"]},
        },
        "activity_tip": "실내 활동을 추천해요. 외출 시에는 목도리, 장갑 등 방한용품을 꼭 챙기세요!"
    },
    "10도 이하": {
        "items": {
            "캐주얼": {"아우터": ["🧥 경량패딩", "🧥 야상"], "상의": ["👕 맨투맨", "👕 후드티"], "하의": ["👖 청바지", "👖 면바지"]},
            "비즈니스": {"아우터": ["🧥 트렌치 코트", "🧥 울 자켓"], "상의": ["👔 셔츠", "🧶 얇은 니트"], "하의": ["👖 슬랙스"]},
            "스포티": {"아우터": ["🧥 플리스 자켓"], "상의": ["👕 긴팔 티셔츠"], "하의": ["👖 조거 팬츠"]},
            "페미닌": {"아우터": ["🧥 트위드 자켓"], "상의": ["👚 블라우스", "🧶 가디건"], "하의": ["👗 미디 스커트"]},
            "미니멀": {"아우터": ["🧥 바람막이"], "상의": ["👕 기본 긴팔티"], "하의": ["👖 블랙진"]},
        },
        "activity_tip": "따뜻한 차 한 잔과 함께 공원을 산책하거나, 예쁜 카페에 가기 좋은 날씨예요."
    },
    "20도 이하": {
        "items": {
            "캐주얼": {"아우터": ["🧥 가디건", "🧥 청자켓"], "상의": ["👕 셔츠", "👕 긴팔티"], "하의": ["👖 면바지", "👖 청바지"]},
            "비즈니스": {"아우터": ["🧥 얇은 자켓", "🧥 블레이저"], "상의": ["👔 셔츠"], "하의": ["👖 슬랙스", "👗 원피스"]},
            "스포티": {"아우터": ["🧥 바람막이"], "상의": ["👕 PK 티셔츠"], "하의": ["👖 반바지", "👖 레깅스"]},
            "페미닌": {"아우터": ["🧥 가디건"], "상의": ["👚 블라우스", "👗 얇은 원피스"], "하의": ["👗 롱스커트"]},
            "미니멀": {"아우터": ["🧥 얇은 바람막이"], "상의": ["👕 U넥 티셔츠"], "하의": ["👖 청바지"]},
        },
        "activity_tip": "야외 활동하기 완벽한 날씨! 자전거를 타거나 가까운 곳으로 피크닉을 떠나보세요."
    },
    "28도 이하": {
        "items": {
            "캐주얼": {"상의": ["👕 반팔 티셔츠"], "하의": ["👖 반바지", "👖 린넨 바지"]},
            "비즈니스": {"상의": ["👔 린넨 셔츠", "👕 PK 셔츠"], "하의": ["👖 린넨 슬랙스"]},
            "스포티": {"상의": ["👕 기능성 반팔"], "하의": ["🩳 스포츠 반바지"]},
            "페미닌": {"상의": ["👚 퍼프 소매 블라우스"], "하의": ["👗 롱 원피스", "👗 숏츠"]},
            "미니멀": {"상의": ["👕 기본 반팔티"], "하의": ["👖 와이드 숏츠"]},
        },
        "activity_tip": "외출하기 좋은 날씨! 친구들과 만나거나 가벼운 산책을 즐겨보세요."
    },
    "28도 초과": {
        "items": {
            "캐주얼": {"상의": ["🎽 민소매", "👕 얇은 반팔"], "하의": ["🩳 짧은 반바지"]},
            "비즈니스": {"상의": ["👔 반팔 셔츠"], "하의": ["👖 쿨맥스 슬랙스"]},
            "스포티": {"상의": ["🎽 기능성 민소매"], "하의": ["🩳 러닝 숏츠"]},
            "페미닌": {"상의": ["👗 끈 원피스"], "하의": ["🩳 린넨 숏츠"]},
            "미니멀": {"상의": ["🎽 슬리브리스 탑"], "하의": ["👖 3부 팬츠"]},
        },
        "activity_tip": "너무 더워요! 수분 섭취는 필수! 시원한 실내에서 영화나 전시를 보는 건 어때요?"
    }
}

# 평균 기온과 일교차를 바탕으로 옷 추천, 활동팁, 레이어링팁을 모두 생성하여 반환.
def generate_recommendations(avg_temp, temp_diff):
    temp_range_data = None
    if avg_temp <= 5:
        temp_range_data = STYLE_RECOMMENDATIONS["5도 이하"]
    elif avg_temp <= 10:
        temp_range_data = STYLE_RECOMMENDATIONS["10도 이하"]
    elif avg_temp <= 20:
        temp_range_data = STYLE_RECOMMENDATIONS["20도 이하"]
    elif avg_temp <= 28:
        temp_range_data = STYLE_RECOMMENDATIONS["28도 이하"]
    else:
        temp_range_data = STYLE_RECOMMENDATIONS["28도 초과"]
    
    # 옷 추천, 활동팁 가져오기
    style_recs = temp_range_data['items']
    activity_tip = temp_range_data['activity_tip']
    
    # 레이어링팁 생성
    layering_tip = ""
    if temp_diff >= 10:
        layering_tip = "🌡️ 일교차가 매우 큽니다! 겉옷을 여러 벌 준비하여 레이어링하세요."
    elif temp_diff >= 7:
        layering_tip = "🌡️ 일교차가 큰 편이니 얇은 겉옷을 준비하세요."
        
    return style_recs, activity_tip, layering_tip